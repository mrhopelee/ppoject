<!doctype html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>瀑布流一</title>
    <!-- External CSS all-->
    <link rel="stylesheet" href="http://libs.useso.com/js/bootstrap/3.2.0/css/bootstrap.css">
    <!-- In-document CSS -->
    <style>
        .HomePage{
            width: 1250px;
            margin: 0 auto;
        }
        .Module{
            width: 250px;
            margin: 30px auto;
            /*text-align: center;*/
            float: left;
            background-color: #DDDDDD;
        }
        .item{
            margin: 14px 7px 0 7px;
            width: 236px;
        }
        .item>a>img{
            width: 236px;
        }

    </style>
    <!-- External JavaScript all -->
    <script src="http://libs.useso.com/js/jquery/2.1.1/jquery.js"></script>
    <script src="http://libs.useso.com/js/bootstrap/3.2.0/js/bootstrap.js"></script>
    <!--<script src="javascript/masonry.pkgd.js"></script>-->
    <!-- In-document JavaScript -->

</head>
<body>
<div class="HomePage">
    <div class="Module" id="m1">
        <div class="item"><a href=""><img src="pblimg/P_001.jpg" alt=""/></a></div>
        <div class="item"><a href=""><img src="pblimg/P_002.jpg" alt=""/></a></div>
        <div class="item"><a href=""><img src="pblimg/P_003.jpg" alt=""/></a></div>
        <div class="item"><a href=""><img src="pblimg/P_004.jpg" alt=""/></a></div>
        <div class="item"><a href=""><img src="pblimg/P_005.jpg" alt=""/></a></div>
        <span>0</span>
        <!--style="position: fixed; top: 0px;"-->
    </div>
    <div class="Module">
        <div class="item"><a href=""><img src="pblimg/P_006.jpg" alt=""/></a></div>
        <div class="item"><a href=""><img src="pblimg/P_007.jpg" alt=""/></a></div>
        <div class="item"><a href=""><img src="pblimg/P_008.jpg" alt=""/></a></div>
        <div class="item"><a href=""><img src="pblimg/P_009.jpg" alt=""/></a></div>
        <div class="item"><a href=""><img src="pblimg/P_010.jpg" alt=""/></a></div>
        <span>1</span>
    </div>
    <div class="Module" id="m2">
        <div class="item"><a href=""><img src="pblimg/P_011.jpg" alt=""/></a></div>
        <div class="item"><a href=""><img src="pblimg/P_012.jpg" alt=""/></a></div>
        <div class="item"><a href=""><img src="pblimg/P_013.jpg" alt=""/></a></div>
        <div class="item"><a href=""><img src="pblimg/P_014.jpg" alt=""/></a></div>
        <div class="item"><a href=""><img src="pblimg/P_015.jpg" alt=""/></a></div>
        <span>2</span>
    </div>
    <div class="Module">
        <div class="item"><a href=""><img src="pblimg/P_016.jpg" alt=""/></a></div>
        <div class="item"><a href=""><img src="pblimg/P_017.jpg" alt=""/></a></div>
        <div class="item"><a href=""><img src="pblimg/P_018.jpg" alt=""/></a></div>
        <div class="item"><a href=""><img src="pblimg/P_019.jpg" alt=""/></a></div>
        <div class="item"><a href=""><img src="pblimg/P_020.jpg" alt=""/></a></div>
        <span>3</span>
    </div>
    <div class="Module">
        <div class="item"><a href=""><img src="pblimg/P_021.jpg" alt=""/></a></div>
        <div class="item"><a href=""><img src="pblimg/P_022.jpg" alt=""/></a></div>
        <div class="item"><a href=""><img src="pblimg/P_023.jpg" alt=""/></a></div>
        <div class="item"><a href=""><img src="pblimg/P_024.jpg" alt=""/></a></div>
        <div class="item"><a href=""><img src="pblimg/P_025.jpg" alt=""/></a></div>
        <span>4</span>
    </div>
</div>
<script>
    /*var module={
     bottomheight:$(".Module"),
     get_b_h: function() {
     var bh = this.bottomheight;
     return bh;
     }
     };*/
    var temp = 26;  /*第一张未加载的图片*/
    var max =160;   /*图片总数*/
    $(document).ready(	function() {

    });
    /*滚动监听*/
    $(document).scroll(function() {
        whenaction();
    });
    $(window).resize(function() {
        whenaction();
    });
    function whenaction() {
        var m = $(".Module");
        for(var i = 0; i < m.length; i++) {
            var l = m.eq(i).children(".item").last();
            var span0 = m.eq(i).children("span");
            var gdtHeight = $(document).scrollTop()+(window.innerHeight || document.documentElement.clientHeight)-100;
            if(l.offset().top + l.height() < gdtHeight){
                append({l: l, span0: span0});
            }
            /*span0.html($(document).scrollTop()+(window.innerHeight || document.documentElement.clientHeight));*/
        }
    }
    /*插入图片*/
    function append(parameters) {
        var str = null;
        var span0 = parameters.span0;
        if(temp <= max) {
            if(temp < 100) {
                str = "<div class=\"item\"><a href=\"\"><img src=\"pblimg/P_0"+temp+".jpg\" alt=\"\"/></a></div>"
                span0.html(temp);
                temp++;
            }else {
                str = "<div class=\"item\"><a href=\"\"><img src=\"pblimg/P_"+temp+".jpg\" alt=\"\"/></a></div>"
                span0.html(temp);
                temp++;
            }
            var l = parameters.l;
            l.append(str);
            return this;
        }else {
            return this;
        }
    }

</script>
</body>
</html>